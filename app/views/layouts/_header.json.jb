json = {}

if json_token = current_endpoint&.token || current_user&.token
  json[:session] = { token: json_token }
end

unless @pagy.nil?
  json[:page] = @pagy.page
  json[:pages] = @pagy.pages
  json[:from] = @pagy.from
  json[:to] = @pagy.to
end

if @object && @object.errors.any?
  json[:errors] = @object
end

json
