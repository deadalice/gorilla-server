json = render 'layouts/array', array: @product

json[:products] = @products.map do |product|
  render 'show', product: product
end

json
